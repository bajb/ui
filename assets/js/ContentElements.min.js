var QueryBuilderConstants=QueryBuilderConstants||{};!function(a){"use strict";function b(b){if(this.key="",this.displayName="- SELECT -",this.dataType=QueryBuilderConstants.DATATYPE_STRING,this.comparators=[QueryBuilderConstants.COMPARATOR_EQUALS],this.inputType=null,this.required=!1,this.unique=!1,this.values="",this.valuesUrl="",this.strictValues=!0,this.count=0,b){var c=this;a.each(b,function(a,b){c.hasOwnProperty(a)&&(c[a]=b)})}}function c(a,b,c,d){this._queryBuilder=a,this._key=b||"",this._comparator=c||"",this._value=null!==d?d:null,this._valCache={},this._valCache[this._comparator]=this._value,this._element=null}function d(a){function b(a){var b=a.getDefinition();return b&&b.hasValues()&&!b.hasAjaxValues()?QueryBuilderConstants.INPUT_SELECT:void 0}this._ele=a,this._options={},this._definitions=[],this._rules=[new c(this,"","",null)],this._initialisedRules=!1,this._initialisedDefinitions=!1,this._inputTypeProcessors=[],this._inputMethods={},this._inputTypes={},this._comparatorNames={},this.setInputMethod(QueryBuilderConstants.INPUT_TEXT,h),this.setInputMethod(QueryBuilderConstants.INPUT_NUMBER,l),this.setInputMethod(QueryBuilderConstants.INPUT_DECIMAL,k),this.setInputMethod(QueryBuilderConstants.INPUT_SELECT,j),this.setInputMethod(QueryBuilderConstants.INPUT_DATE,m),this.setInputMethod(QueryBuilderConstants.INPUT_BOOL,i),this.setInputMethod(QueryBuilderConstants.INPUT_AGE,n),this.setInputType(QueryBuilderConstants.COMPARATOR_EQUALS,QueryBuilderConstants.DATATYPE_STRING,QueryBuilderConstants.INPUT_TEXT),this.setInputType(QueryBuilderConstants.COMPARATOR_EQUALS,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_NUMBER),this.setInputType(QueryBuilderConstants.COMPARATOR_EQUALS,QueryBuilderConstants.DATATYPE_DATE,QueryBuilderConstants.INPUT_DATE),this.setInputType(QueryBuilderConstants.COMPARATOR_EQUALS,QueryBuilderConstants.DATATYPE_BOOL,QueryBuilderConstants.INPUT_BOOL),this.setInputType(QueryBuilderConstants.COMPARATOR_EQUALS_INSENSITIVE,QueryBuilderConstants.DATATYPE_STRING,QueryBuilderConstants.INPUT_TEXT),this.setInputType(QueryBuilderConstants.COMPARATOR_EQUALS_INSENSITIVE,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_NUMBER),this.setInputType(QueryBuilderConstants.COMPARATOR_EQUALS_INSENSITIVE,QueryBuilderConstants.DATATYPE_DATE,QueryBuilderConstants.INPUT_DATE),this.setInputType(QueryBuilderConstants.COMPARATOR_EQUALS_INSENSITIVE,QueryBuilderConstants.DATATYPE_BOOL,QueryBuilderConstants.INPUT_BOOL),this.setInputType(QueryBuilderConstants.COMPARATOR_NOT_EQUAL,QueryBuilderConstants.DATATYPE_STRING,QueryBuilderConstants.INPUT_TEXT),this.setInputType(QueryBuilderConstants.COMPARATOR_NOT_EQUAL,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_NUMBER),this.setInputType(QueryBuilderConstants.COMPARATOR_NOT_EQUAL,QueryBuilderConstants.DATATYPE_DATE,QueryBuilderConstants.INPUT_DATE),this.setInputType(QueryBuilderConstants.COMPARATOR_NOT_EQUAL,QueryBuilderConstants.DATATYPE_BOOL,QueryBuilderConstants.INPUT_BOOL),this.setInputType(QueryBuilderConstants.COMPARATOR_GREATER,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_NUMBER),this.setInputType(QueryBuilderConstants.COMPARATOR_GREATER,QueryBuilderConstants.DATATYPE_DATE,QueryBuilderConstants.INPUT_DATE),this.setInputType(QueryBuilderConstants.COMPARATOR_GREATER,QueryBuilderConstants.DATATYPE_DECIMAL,QueryBuilderConstants.INPUT_DECIMAL),this.setInputType(QueryBuilderConstants.COMPARATOR_GREATER_EQUAL,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_NUMBER),this.setInputType(QueryBuilderConstants.COMPARATOR_GREATER_EQUAL,QueryBuilderConstants.DATATYPE_DATE,QueryBuilderConstants.INPUT_DATE),this.setInputType(QueryBuilderConstants.COMPARATOR_GREATER_EQUAL,QueryBuilderConstants.DATATYPE_DECIMAL,QueryBuilderConstants.INPUT_DECIMAL),this.setInputType(QueryBuilderConstants.COMPARATOR_LESS,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_NUMBER),this.setInputType(QueryBuilderConstants.COMPARATOR_LESS,QueryBuilderConstants.DATATYPE_DATE,QueryBuilderConstants.INPUT_DATE),this.setInputType(QueryBuilderConstants.COMPARATOR_LESS,QueryBuilderConstants.DATATYPE_DECIMAL,QueryBuilderConstants.INPUT_DECIMAL),this.setInputType(QueryBuilderConstants.COMPARATOR_LESS_EQUAL,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_NUMBER),this.setInputType(QueryBuilderConstants.COMPARATOR_LESS_EQUAL,QueryBuilderConstants.DATATYPE_DATE,QueryBuilderConstants.INPUT_DATE),this.setInputType(QueryBuilderConstants.COMPARATOR_LESS_EQUAL,QueryBuilderConstants.DATATYPE_DECIMAL,QueryBuilderConstants.INPUT_DECIMAL),this.setInputType(QueryBuilderConstants.COMPARATOR_BETWEEN,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_NUMBER),this.setInputType(QueryBuilderConstants.COMPARATOR_BETWEEN,QueryBuilderConstants.DATATYPE_DATE,QueryBuilderConstants.INPUT_DATE),this.setInputType(QueryBuilderConstants.COMPARATOR_BETWEEN,QueryBuilderConstants.DATATYPE_DECIMAL,QueryBuilderConstants.INPUT_DECIMAL),this.setInputType(QueryBuilderConstants.COMPARATOR_BEFORE,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_AGE),this.setInputType(QueryBuilderConstants.COMPARATOR_AFTER,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_AGE),this.setInputType(QueryBuilderConstants.COMPARATOR_LIKE,QueryBuilderConstants.DATATYPE_STRING,QueryBuilderConstants.INPUT_TEXT),this.setInputType(QueryBuilderConstants.COMPARATOR_STARTS,QueryBuilderConstants.DATATYPE_STRING,QueryBuilderConstants.INPUT_TEXT),this.setInputType(QueryBuilderConstants.COMPARATOR_ENDS,QueryBuilderConstants.DATATYPE_STRING,QueryBuilderConstants.INPUT_TEXT),this.setComparatorName(QueryBuilderConstants.COMPARATOR_EQUALS,"Equals"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_EQUALS_INSENSITIVE,"Equals (insensitive)"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_NOT_EQUAL,"Does Not Equal"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_IN,"In"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_NOT_IN,"Not In"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_GREATER,"Greater Than"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_GREATER_EQUAL,"Greater Than or Equal to"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_LESS,"Less Than"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_LESS_EQUAL,"Less Than or Equal to"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_BETWEEN,"Between"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_LIKE,"Like"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_STARTS,"Starts With"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_ENDS,"Ends With"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_BEFORE,"Was Before"),this.setComparatorName(QueryBuilderConstants.COMPARATOR_AFTER,"Was After"),this.addInputTypeProcessor(b)}function e(b,c){var d=a("<select/>");if(c&&-1==Object.keys(b).indexOf(c)){var e=a("<option/>").text(c).attr("value",c);e.attr("selected","selected"),e.attr("disabled","disabled"),d.append(e)}return a.each(b,function(b){var e=a("<option/>").text(this).attr("value",b);b==c&&e.attr("selected","selected"),d.append(e)}),d}const f="querybuilder",g=f+".rule";QueryBuilderConstants.INPUT_TEXT="text",QueryBuilderConstants.INPUT_NUMBER="number",QueryBuilderConstants.INPUT_DECIMAL="decimal",QueryBuilderConstants.INPUT_SELECT="select",QueryBuilderConstants.INPUT_DATE="date",QueryBuilderConstants.INPUT_BOOL="bool",QueryBuilderConstants.INPUT_AGE="age",QueryBuilderConstants.DATATYPE_STRING="string",QueryBuilderConstants.DATATYPE_NUMBER="number",QueryBuilderConstants.DATATYPE_DECIMAL="decimal",QueryBuilderConstants.DATATYPE_DATE="date",QueryBuilderConstants.DATATYPE_BOOL="bool",QueryBuilderConstants.COMPARATOR_EQUALS="eq",QueryBuilderConstants.COMPARATOR_EQUALS_INSENSITIVE="eqi",QueryBuilderConstants.COMPARATOR_NOT_EQUAL="neq",QueryBuilderConstants.COMPARATOR_IN="in",QueryBuilderConstants.COMPARATOR_NOT_IN="nin",QueryBuilderConstants.COMPARATOR_GREATER="gt",QueryBuilderConstants.COMPARATOR_GREATER_EQUAL="gte",QueryBuilderConstants.COMPARATOR_LESS="lt",QueryBuilderConstants.COMPARATOR_LESS_EQUAL="lte",QueryBuilderConstants.COMPARATOR_BETWEEN="bet",QueryBuilderConstants.COMPARATOR_LIKE="like",QueryBuilderConstants.COMPARATOR_STARTS="starts",QueryBuilderConstants.COMPARATOR_ENDS="ends",QueryBuilderConstants.COMPARATOR_BEFORE="before",QueryBuilderConstants.COMPARATOR_AFTER="after",a.fn.QueryBuilder=function(b){var c=Array.prototype.slice.call(arguments);if(b?"object"==typeof b&&(b="init",c.unshift("init")):b="init","function"!=typeof d.prototype[b])throw"QueryBuilder command '"+b+"' not found";c.shift();var e=a(this);return a(this).each(function(){var g=a(this),h=g.data(f);h||(g.data(f,new d(this)),h=g.data(f));var i=h[b].apply(h,c);i&&(e=i)}),e},a(document).on("change",".qb-rule .qb-key",function(){var b=a(this).closest(".qb-container"),c=(b.data(f),a(this).closest(".qb-rule")),d=c.data(g);d.setKey(a(this).val())}),a(document).on("change",".qb-rule .qb-comparator",function(){var b=a(this).closest(".qb-container"),c=(b.data(f),a(this).closest(".qb-rule")),d=c.data(g);d.setComparator(a(this).val())}),a(document).on("click","button.qb-remove-rule",function(){var b=a(this).closest(".qb-container"),c=b.data(f),d=a(this).closest(".qb-rule"),e=d.data(g);c.removeRule(e)}),a(document).on("click","button.qb-add-rule",function(){a(this).closest(".qb-container").QueryBuilder("addRule")}),function(){b.prototype.hasValues=function(){return!!this.values},b.prototype.hasAjaxValues=function(){return!!this.valuesUrl},b.prototype.isStrict=function(){return!!this.strictValues}}(),function(){function b(){var a=this._queryBuilder.getInputTypeForRule(this),b=this._queryBuilder.getInputMethod(a);if(!b)throw"Input type not found for "+this.getComparator()+" "+this.getDefinition().dataType;return new b(this)}c.prototype.constructor=c,c.prototype.getValue=function(){return this._value},c.prototype.setValue=function(b){this._setValue(b),this.render(),a(this._queryBuilder._ele).trigger("change.querybuilder",[this._queryBuilder.rules()])},c.prototype._setValue=function(b){this._value=b,a(this._queryBuilder._ele).trigger("change.querybuilder",[this._queryBuilder.rules()])},c.prototype.getComparator=function(){return this._comparator},c.prototype.setComparator=function(b){this._valCache[this._comparator]=this.getValue(),this._comparator=b,this._element&&a(".qb-comparator",this._element).length&&a(".qb-comparator",this._element).val(b),this.setValue(this._valCache[this._comparator]?this._valCache[this._comparator]:null)},c.prototype.getKey=function(){return this._key},c.prototype.setKey=function(b){this._queryBuilder.changeCount(this._key,b),this._key=b,this._element&&a(".qb-key",this._element).val(b);var c=this.getDefinition().comparators;-1==c.indexOf(this.getComparator())?this.setComparator(c[0]):this.setValue(null)},c.prototype.render=function(){var c=this,d=a('<div class="qb-rule"/>'),e=a('<select class="qb-key"/>'),f=this.getKey();d.data(g,this),d.append(e);var h=this.getDefinition();if(f||e.append('<option selected="selected" value="">- SELECT -</option>'),f&&!h&&e.append('<option selected="selected" value="'+f+'">'+f+"</option>"),a.each(this._queryBuilder.definitions(),function(b,d){var g=a('<option value="'+d.key+'">'+this.displayName+"</option>");f==d.key&&g.attr("selected","selected"),d.unique&&(g.addClass("unique-"+d.key),c._queryBuilder.getCount(d.key)&&g.attr("disabled","disabled")),e.append(g)}),h){h&&h.required&&h.count<=1&&e.attr("disabled","disabled"),h&&!h.dataType&&(h.dataType="string"),h&&!h.comparators&&(h.comparators=["eq"]);var i=a('<select class="qb-comparator"/>');h.dataType!=QueryBuilderConstants.DATATYPE_BOOL&&d.append(i),a.each(h?h.comparators:[QueryBuilderConstants.COMPARATOR_EQUALS],function(a,b){var d=c.getComparator()==b?' selected="selected"':"";i.append("<option"+d+' value="'+b+'">'+c._queryBuilder.getComparatorName(b)+"</option>")});var j=b.call(this),k=j.render();null===this.getValue()&&k.is("select")&&0==a("option[selected]",k).length&&this.setValue(a("option",k).first().attr("selected","selected").attr("value")),d.append(k),j.postRender&&j.postRender()}var l=a('<button class="qb-button qb-remove-rule">x</button>');return d.append(l),h&&h.required&&h.count<=1&&l.hide(),!h&&this.getKey()&&(e.attr("disabled","disabled"),i.attr("disabled","disabled"),k.attr("disabled","disabled")),this._element?(this._element.replaceWith(d),this._element=d,a(this._queryBuilder._ele).trigger("render.querybuilder",this)):this._element=d,d},c.prototype.getDefinition=function(){return this._queryBuilder.getDefinition(this.getKey())},c.prototype.getData=function(){return{key:this.getKey(),comparator:this.getComparator(),value:this.getValue()}},c.prototype.removeElement=function(){this._element&&this._element.remove()},c.prototype.getElement=function(){return this._element}}(),function(){function e(a){if(this._definitions.length>0)f.call(this,a);else var b=this,c=setInterval(function(){b._definitions.length>0&&(f.call(b,a),clearInterval(c))},100)}function f(b){for(var c=this;this._rules.length;)c.removeRule(this._rules[0],!0);b&&(a.each(b,function(a){"object"==typeof this?this instanceof String?c.addRule(a,"eq",this):"key"in this&&"comparator"in this&&"value"in this?c.addRule(this.key,this.comparator,this.value):c.addRule(a,"in",this):c.addRule(a,"eq",this)}),c._initialisedRules=!0,this.redraw(),c._rules.length||c.addRule("","",null))}d.prototype.constructor=d,d.prototype.setInputMethod=function(a,b){this._inputMethods[a]=b},d.prototype.getInputMethod=function(a){return this._inputMethods[a]},d.prototype.setInputType=function(a,b,c){this._inputTypes[a]||(this._inputTypes[a]={}),this._inputTypes[a][b]=c},d.prototype.getInputType=function(a,b){return this._inputTypes[a]&&this._inputTypes[a][b]?this._inputTypes[a][b]:this._inputTypes[QueryBuilderConstants.COMPARATOR_EQUALS][QueryBuilderConstants.DATATYPE_STRING]},d.prototype.setComparatorName=function(a,b){this._comparatorNames[a]=b},d.prototype.getComparatorName=function(a){return this._comparatorNames[a]?this._comparatorNames[a]:a},d.prototype.addInputTypeProcessor=function(a){this._inputTypeProcessors.push(a)},d.prototype.getInputTypeForRule=function(b){var c=b.getDefinition(),d=c&&c.inputType?c.inputType:null;if(!d){var e=c&&c.dataType?c.dataType:QueryBuilderConstants.DATATYPE_STRING;d=this.getInputType(b.getComparator(),e)}return a(this._inputTypeProcessors).each(function(){var a=this(b);a&&(d=a)}),d},d.prototype.init=function(b){var c=a(this._ele);c.addClass("qb-container").html(a('<div class="qb-rules"/>')).append(a('<button class="qb-button qb-add-rule">+</button>')),c.trigger("init.querybuilder",this),b=a.extend({},c.data(),b),this.options(b),this._options&&"definitions"in this._options&&this._options.definitions&&this.definitions(this._options.definitions),this._options&&"rules"in this._options&&this._options.rules&&this.rules(this._options.rules)},d.prototype.options=function(a){return void 0===a?this._options:(this._options=a,void this.redraw())},d.prototype.definitions=function(c){var d=this;return void 0===c?this._definitions:(this._initialisedDefinitions=!1,void("string"==typeof c?a.getJSON(c,{},function(c){d._definitions=[],a.each(c,function(){d._definitions.push(new b(this))}),d._initialisedDefinitions=!0,d.redraw()}):(this._definitions=[],a.each(c,function(){d._definitions.push(new b(this))}),d._initialisedDefinitions=!0,this.redraw())))},d.prototype.getDefinition=function(b){var c=null;return a.each(this._definitions,function(){return this.key==b?(c=this,!1):void 0}),c},d.prototype.rules=function(b){var c=this;if(void 0===b){var d=[];return a(this._rules).each(function(){this.getKey()&&d.push(this.getData())}),d}if(this._initialisedRules=!1,"object"==typeof b)return e.call(this,b),null;if("function"==typeof b)return e.call(this,b()),null;if("string"==typeof b)return a.getJSON(b,{},function(a){e.call(c,a)}),null;throw"Unknown data format for rules"},d.prototype.addRule=function(b,d,e){this.incrementCounter(b);var f=new c(this,b,d,e);if((!b||f.getDefinition())&&(this._rules.push(f),this._initialisedDefinitions)){var g=f.render();a(".qb-rules",this._ele).append(g),a(this._ele).trigger("render.querybuilder",f)}},d.prototype.redraw=function(){if(this._initialisedDefinitions){var b=this;if(a(".qb-rules",this._ele).empty(),a.each(this._rules,function(){var c=this.render();a(".qb-rules",b._ele).append(c),a(b._ele).trigger("render.querybuilder",this)}),b._definitions&&(a.each(b._definitions,function(){if(this.required){var c=this,d=!1;a.each(b._rules,function(){this.getKey()==c.key&&(d=!0)}),d||b.addRule(c.key,c.comparators[0],null)}}),this._definitions.length)){var c=0;a.each(this._definitions,function(){this.unique||c++}),c||a(".qb-add-rule").hide()}this._initialisedRules&&a(b._ele).trigger("change.querybuilder",[b.rules()])}},d.prototype.removeRule=function(b,c){var d=this,e=b.getKey();this.decrementCounter(e),b.removeElement(),a.each(this._rules,function(a){this==b&&d._rules.splice(a,1)}),a(".qb-rule",this._ele).length||c||this.addRule("","",null),a(this._ele).trigger("change.querybuilder",[this.rules()])},d.prototype.getCount=function(a){var b=this.getDefinition(a);return b?b.count:0},d.prototype.changeCount=function(a,b){this.decrementCounter(a),this.incrementCounter(b)},d.prototype.incrementCounter=function(b){var c=this.getDefinition(b);c&&(c.count++,c.unique&&a(".qb-key .unique-"+b,this._ele).attr("disabled","disabled"),c.required&&c.count>1&&a.each(this._rules,function(){this.getKey()==b&&(a(".qb-remove-rule",this.getElement()).show(),a(".qb-key",this.getElement()).attr("disabled",!1))}))},d.prototype.decrementCounter=function(b){var c=this.getDefinition(b);c&&(c.count--,c.unique&&0==c.count&&a(".qb-key .unique-"+b,this._ele).attr("disabled",null),c.required&&1==c.count&&a.each(this._rules,function(){this.getKey()==b&&a(".qb-remove-rule",this.getElement()).hide()}))}}();var h=function(){function b(a){this._rule=a,null===this._rule._value&&(this._rule._value="")}return b.prototype.render=function(){var b=this;return a('<input type="text"/>').attr("value",this._rule._value).on("change",function(){b._rule._setValue(a(this).val())})},b}(),i=function(){function b(a){this._rule=a,null===this._rule._value&&(this._rule._value="1")}return b.prototype.render=function(){var b=this;return e({1:"True",0:"False"},this._rule._value).on("change",function(){b._rule._setValue(a(this).val())})},b}(),j=function(){function b(a){this._rule=a,null===this._rule._value&&(this._rule._value=null)}return b.prototype.render=function(){var b=this;return e(this._rule.getDefinition().values,this._rule._value).on("change",function(){b._rule._setValue(a(this).val())})},b}(),k=function(){function b(a){this._rule=a,null===this._rule._value&&(this._rule._value=0)}return b.prototype.render=function(){var b=this;return a('<input type="number" step="0.01" />').attr("value",this._rule._value).on("change",function(){b._rule._setValue(a(this).val())})},b}(),l=function(){function b(a){this._rule=a,null===this._rule._value&&(this._rule._value=0)}return b.prototype.render=function(){var b=this;return a('<input type="number" />').attr("value",this._rule._value).on("change",function(){b._rule._setValue(a(this).val())})},b}(),m=function(){function b(a){this._rule=a,null===this._rule._value&&(this._rule._value=c())}function c(){var a=new Date,b=a.getFullYear();return b+="-"+("0"+(a.getMonth()+1)).slice(-2),b+="-"+("0"+a.getDate()).slice(-2)}return b.prototype.render=function(){var b=this;return a('<input type="date" />').val(this._rule._value).on("change",function(){b._rule._setValue(a(this).val())})},b}(),n=function(){function b(a){this._rule=a,null===this._rule._value&&(this._rule._value=-10080)}return b.prototype.render=function(){var b=this,c=this._rule._value,d=1,e=a('<input class="age-count" type="number" />'),f=a('<select class="age-unit"/>'),g=a('<select class="age-unit"></select>'),h={Minutes:1,Hours:60,Days:1440,Weeks:10080},i=[];for(var j in h)h.hasOwnProperty(j)&&i.push([j,h[j]]);i.sort(function(a,b){return a[1]-b[1]}),a.each(i.slice().reverse(),function(a,b){return c%b[1]==0?(d=b[1],c/=b[1],!1):void 0}),a.each(i,function(b,c){var e=a("<option>").val(c[1]).text(c[0]);d==c[1]&&e.attr("selected",!0),f.append(e)}),e.val(Math.abs(c));var k=a('<option value="-1">Ago</option>'),l=a('<option value="1">From now</option>');this._rule._value<=0?k.attr("selected",!0):l.attr("selected",!0),g.append(k,l);var m=a().add(e).add(f).add(g);return m.on("change",function(){b._rule._setValue(e.val()*f.val()*g.val())}),m},b}()}(jQuery);var QueryBuilderConstants=QueryBuilderConstants||{};!function(){function a(a){var b=a.getDefinition();return b&&(b.hasAjaxValues()||b.hasValues()&&!b.isStrict())?QueryBuilderConstants.INPUT_TOKEN:void 0}QueryBuilderConstants.INPUT_TOKEN="token";var b=function(){function a(a){this._rule=a,this._token=null,null===this._rule._value&&(this._rule._value="")}return a.prototype.tokenChanged=function(a,b,c){var d=this._token.tokenize().toArray();this._rule._setValue(d.length?d:"")},a.prototype.render=function(){var a=$('<select class="qb-tokenizer qb-input"/>');return this._token=a,a},a.prototype.postRender=function(){var a=this,b=this._rule.getDefinition(),c=this._rule._value,d={debounce:250,autosize:!0,onAddToken:function(b,c,d){a.tokenChanged(b,c,d)},onRemoveToken:function(b,c,d){a.tokenChanged(b,c,d)}};if(c instanceof Object||(c=[c]),b.hasValues()){var e=$.extend({},b.values);$.each(c,function(a,b){-1==Object.keys(e).indexOf(b)&&(e[b]=b)}),$.each(e,function(b){if(b){var d=$("<option/>").val(encodeURIComponent(b));c.indexOf(b)>-1&&d.attr("selected","selected"),a._token.append(d)}})}b.isStrict()&&(d.newElements=!1),b.hasAjaxValues()&&(d.datas=b.valuesUrl),[QueryBuilderConstants.COMPARATOR_IN,QueryBuilderConstants.COMPARATOR_NOT_IN].indexOf(this._rule.getComparator())<0&&(d.maxElements=1),this._token.tokenize(d),$.each(c,function(b,c){a._token.tokenize().dropdownAddItem(c,c).tokenAdd(c,c)})},a}();$(document).on("init.querybuilder",function(c,d){d.setInputMethod(QueryBuilderConstants.INPUT_TOKEN,b),d.setInputType(QueryBuilderConstants.COMPARATOR_IN,QueryBuilderConstants.DATATYPE_STRING,QueryBuilderConstants.INPUT_TOKEN),d.setInputType(QueryBuilderConstants.COMPARATOR_IN,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_TOKEN),d.setInputType(QueryBuilderConstants.COMPARATOR_NOT_IN,QueryBuilderConstants.DATATYPE_STRING,QueryBuilderConstants.INPUT_TOKEN),d.setInputType(QueryBuilderConstants.COMPARATOR_NOT_IN,QueryBuilderConstants.DATATYPE_NUMBER,QueryBuilderConstants.INPUT_TOKEN),d.addInputTypeProcessor(a)})}();var FortifiContentElements={};