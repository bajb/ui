!function(a){function b(a){this._ele=a,this._options={},this._definitions=[],this._rules=[]}var c={rules:null,definitions:null};a.fn.QueryBuilder=function(c){var d=Array.prototype.slice.call(arguments);if(c?"object"==typeof c&&(c="init",d.unshift("init")):c="init","function"!=typeof b.prototype[c])throw"QueryBuilder command '"+c+"' not found";d.shift();var e=a(this);return a(this).each(function(){var f=a(this),g=f.data("QueryBuilder");g||(f.data("QueryBuilder",new b(this)),g=f.data("QueryBuilder"));var h=g[c].apply(g,d);h&&(e=h)}),e},a(document).on("change",".qb-rule .qb-key",function(){a(this).closest(".qb-container").QueryBuilder("addRule",{key:a(this).val()},a(this).closest(".qb-rules .qb-rule").index()).trigger("change.querybuilder")}),a(document).on("change",".qb-rule .qb-comparator",function(){var b=a(this).closest(".qb-rules .qb-rule");a(this).closest(".qb-container").QueryBuilder("addRule",{key:a(".qb-key",b).val(),comparator:a(this).val(),value:a(".qb-value",b).val()},b.index()).trigger("change.querybuilder")}),a(document).on("change",".qb-container .qb-value",function(){a(this).closest(".qb-container").trigger("change.querybuilder")}),a(document).on("click","button.qb-remove-rule",function(){a(this).closest(".qb-container").QueryBuilder("removeRule",a(this).closest(".qb-rules .qb-rule").index()).trigger("change.querybuilder")}),a(document).on("click","button.qb-add-rule",function(){a(this).closest(".qb-container").QueryBuilder("addRule")}),b.prototype=function(){function d(b,c){var d,e;if(e="bool"==c.dataType?"bool":l[b.comparator][c.dataType],"text"==e&&c.values&&!c.ajaxUrl&&(e="select"),"select"!=e||!b.value||b.value in c.values||(e="text"),!e)throw"Input type not found for "+b.comparator+" "+c.dataType;switch(e){case"text":d=a('<input type="text" value="'+(b.value?b.value:"")+'"/>');break;case"number":d=a('<input type="number" value="'+(b.value?b.value:"")+'"/>');break;case"bool":d=a('<select><option value="1">True</option><option value="0">False</option></select>');break;case"select":d=a("<select/>"),a.each(c.values,function(a){var c=a==b.value?' selected="selected"':"";d.append("<option"+c+' value="'+a+'">'+this+"</option>")});break;case"token":d=a('<input type="text" value="'+(b.value?b.value:"")+'"/>');break;default:throw"Input type not found for "+e}return d.addClass("qb-value"),d}function e(b){var d=a(this._ele);b=a.extend({},c,d.data(),b),this.options(b),this._options&&"definitions"in this._options&&this._options.definitions&&this.definitions(this._options.definitions),this._options&&"rules"in this._options&&this._options.rules&&this.rules(this._options.rules)}function f(a){return void 0===a?this._options:(this._options=a,void this.redraw())}function g(b){var c=this;return void 0===b?this._definitions:"string"==typeof b?void a.getJSON(b,{},function(a){c._definitions=a,c.redraw()}):(this._definitions=b,void this.redraw())}function h(b){var c=this;if(void 0===b){var d=[];return a(".qb-rules .qb-rule",a(this._ele)).each(function(){var b=a(".qb-key",this).val();b&&d.push({key:b,comparator:a(".qb-comparator",this).val()?a(".qb-comparator",this).val():"eq",value:a(".qb-value",this).val()})}),d}if("object"==typeof b){var e=[];return b&&a.each(b,function(a){"object"==typeof this?this instanceof String?e.push({key:a,comparator:"eq",value:this}):"key"in this&&"comparator"in this&&"value"in this?e.push(this):e.push({key:a,comparator:"in",value:this}):e.push({key:a,comparator:"eq",value:this})}),this._rules=e,this.redraw(),null}if("function"==typeof b)return this._rules=b(),this.redraw(),null;if("string"==typeof b)return a.getJSON(b,{},function(a){c._rules=a,c.redraw()}),null;throw"Unknown data format for rules"}function i(){var b=this;if(a(this._ele).hasClass("qb-container")?a(".qb-rules",this._ele).empty():a(this._ele).addClass("qb-container").html(a('<div class="qb-rules"/>')).append(a('<button class="qb-button qb-add-rule">+</button>')),b._definitions&&(b._rules.length&&a.each(b._rules,function(){b.addRule(this)}),a(b._ele).trigger("change.querybuilder"),a.each(b._definitions,function(c){if(this.required){var d=!1;a.each(b._rules,function(){this.key==c&&(d=!0)}),d||b.addRule({key:c})}}),a(".qb-rules .qb-rule",this._ele).length||b.addRule(),this._definitions.length)){var c=0;a.each(this._definitions,function(){this.required||c++}),c||a(".qb-add-rule").hide()}}function j(b){a(".qb-rules .qb-rule",this._ele).get(b).remove(),a(".qb-rule",this._ele).length||this.addRule()}function k(b,c){var e=a('<div class="qb-rule"/>'),f=a('<select class="qb-key"/>').appendTo(e),g=b?b.key:null,h=g?this._definitions[g]:null;if(g||f.append('<option value=""> - SELECT -</option>'),!g||h){if(a.each(this._definitions,function(a){if(!this.required||g===a){var b=g==a?' selected="selected"':"";f.append("<option"+b+' value="'+a+'">'+this.display+"</option>")}}),h){if(h.required&&f.attr("disabled","disabled"),h.dataType||(h.dataType="string"),h.comparators){var i=a('<select class="qb-comparator"/>').appendTo(e);a.each(h.comparators,function(){b.comparator||(b.comparator=this);var a=b.comparator==this?' selected="selected"':"";i.append("<option"+a+' value="'+this+'">'+m[this]+"</option>")})}d(b,h).appendTo(e)}h&&!h.required&&a('<button class="qb-button qb-remove-rule">x</button>').appendTo(e),void 0!==c?a(".qb-rule:eq("+c+")",this._ele).replaceWith(e):e.appendTo(a(".qb-rules",this._ele))}}var l={eq:{string:"text",number:"number",date:"date"},neq:{string:"text",number:"number",date:"date"},"in":{string:"token",number:"token"},nin:{string:"token",number:"token"},gt:{number:"number",date:"date",decimal:"decimal"},gte:{number:"number",date:"date",decimal:"decimal"},lt:{number:"number",date:"date",decimal:"decimal"},lte:{number:"number",date:"date",decimal:"decimal"},bet:{number:"number",date:"date",decimal:"decimal"},age:{date:"age"}},m={eq:"Equals",neq:"Does Not Equal","in":"In",nin:"Not In",gt:"Greater Than",gte:"Greater Than or Equal to",lt:"Less Than",lte:"Less Than or Equal to",bet:"Between",age:"was"};return{constructor:b,init:e,options:f,definitions:g,rules:h,redraw:i,removeRule:j,addRule:k}}()}(jQuery);var FortifiContentElements={};